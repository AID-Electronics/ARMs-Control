////////////////////////////////////////////// PARTE DE MOTORES
#include <mcp_can.h>
#include <SPI.h>
#include "Schneider_LMD_P84.h"
#include <stdio.h>

#define ID_MOTOR_1 0x610
#define ID_MOTOR_2 0x611

///////////////////////////////////////////////////////////////////////////// PARTE DE LA IMU
#include <Adafruit_Sensor.h>
#include <Adafruit_BNO055.h>
#include <Wire.h>
#include <utility/imumaths.h>
                                                        // DATOS FIJOS DEL SISTEMAS DE POLEAS Y ACTUADORES
#define RESOLUCION 0.007  //GRADOS POR PASO
#define RADIO_POLEA 25 //mm
#define ALTURA_POLEAS 360 //mm
#define D_REF 333//mm
#define DIST 50
#define H 360
#define TOL 0.035 
#define MAX 600

sensors_event_t event;

  double cabeceoPosterior=0;

  double alabeoPosterior=0;

  int cont=0;
  int pasosMotor1;
  int pasosMotor2;
  int pasosMotor3;
  int pasosMotor4;
  unsigned long t=0;
  
 const double pi=3.141592;
 double deg2rad= pi/180;
///////////////////////////////////////////////////////////////////////////////////

int muestra;


Adafruit_BNO055 bno = Adafruit_BNO055(55);
void displayCalStatus ()
{
  /*Cogemos los cuatro velores de calibración (0...3)
   * Cualquier sensor cuyo valor sea 0 es ignorado,
   * 3 significa calibrado.
   */
   uint8_t system, gyro, accel, mag;
   system = gyro = accel = mag = 0;
   bno.getCalibration(&system, &gyro, &accel, &mag);

   Serial.print("\t");
   if(!system)
    Serial.print("! ");

   Serial.print("Sys: ");
   Serial.print(system, DEC);
   Serial.print (" G: ");
   Serial.print (gyro, DEC);
   Serial.print (" A: ");
   Serial.print (accel, DEC);
   Serial.print (" M: ");
   Serial.println(mag, DEC);
}


int calcularPasos1D(double cabeceo,double resolucion,double radioPolea,double distCentro)
{ 
  double PASOS;
  double tangente= tan(cabeceo);
  //PASOS=(((tangente*distCentro)/(2*pi*radioPolea))*(360/resolucion)) ;
  PASOS=51200*cabeceo/(2*pi);
  
  int aux=int(PASOS);
  double aux2=abs(PASOS)-abs(aux);
    
  if(abs(aux2)>0.5)
    {
      if (aux>0)
      aux++;
      else
      aux--;
    }
   
  return aux;
  
}

int calcularPasos2D(double cabeceo,double alabeo ,double resolucion,double radioPolea,double h,double posX, double posY,double Dref)
{
    double PASOS;
  double tangenteCAB= tan(cabeceo);  //ES EL ANGULO RESPECTO EL EJE X
  double tangenteAL= tan(alabeo); //ES EL ANGULO RESPECTO EL EJE Y
  double numerador= (sqrt((tangenteCAB*h-posY)*(tangenteCAB*h-posY)+(tangenteAL*h-posX)*(tangenteAL*h-posX))-Dref);
  
  PASOS=((numerador/(2*pi*radioPolea))*(360/resolucion)) ;

  
  int aux=(int)PASOS;
  double aux2=PASOS-aux;

    if(abs(aux2)>0.5)
    {
      if (aux>0)
      aux++;
      else
      aux--;
    }
    
  return aux;
   
}
void setup(){

  ////////////////////////////////////////////////////////////////////IMU
    Serial.begin(115200);

//    if(!bno.begin())
//  {
//    Serial.print("BNO055 no detectado");
//    while(1);
//  }
//
//  delay(1000);
//
//  bno.setExtCrystalUse(true);
//
// displayCalStatus();
//////////////////////////////////////////////////////////////////// CAN BUS

    while (CAN_OK != CAN.begin(CAN_1000KBPS))  {            // init can bus : baudrate = 1000k
        Serial.println("CAN BUS Shield init fail");
        Serial.println(" Init CAN BUS Shield again");
        delay(500);
    }
    Serial.println("CAN BUS Shield init ok!");
    Serial.println();

    delay(200);
  
    setupMotor(ID_MOTOR_1,100000,100000,80,512000); //(long ID_motor,uint32_t Acel,uint32_t Decel, int current ,uint32_t MaxVel )
    setupMotor(ID_MOTOR_2,100000,100000,80,512000);

    muestra = 0;
}


void imprimirDatos(sensors_event_t event){
/*
  Serial.print ("X: ");
  Serial.print (event.orientation.x,4);
  Serial.print ("\tY: ");
  Serial.print (event.orientation.y,4);
  Serial.print ("\tZ: ");
  Serial.println (event.orientation.z,4);
*/

  Serial.print ("  ");
  Serial.print (pasosMotor1);
  Serial.print ("  ");
  Serial.print (pasosMotor2);
  Serial.print ("  ");
  Serial.print (pasosMotor3);
  Serial.print ("  ");
  Serial.print (pasosMotor4);
  Serial.println(" ");
  //delay (2);
  
}


void moverMotores() {
  
      pasosMotor2=calcularPasos2D(cabeceoPosterior,alabeoPosterior,RESOLUCION,RADIO_POLEA,H,333,0,D_REF);
      pasosMotor1=calcularPasos2D(cabeceoPosterior,alabeoPosterior,RESOLUCION,RADIO_POLEA,H,0,333,D_REF);
      pasosMotor4=calcularPasos2D(cabeceoPosterior,alabeoPosterior,RESOLUCION,RADIO_POLEA,H,-333,0,D_REF);
      pasosMotor3=calcularPasos2D(cabeceoPosterior,alabeoPosterior,RESOLUCION,RADIO_POLEA,H,0,-333,D_REF);
      imprimirDatos(event);
      //pasosMotor1=calcularPasos1D(cabeceoPosterior-cabeceoAnterior,RESOLUCION,RADIO_POLEA,H);
      //pasosMotor3=calcularPasos1D(alabeoPosterior-alabeoAnterior,RESOLUCION,RADIO_POLEA,H);

      //AQUI iría la accion de movimiento
      mover(pasosMotor1,ID_MOTOR_1);//una vuelta
      mover(pasosMotor2,ID_MOTOR_2);
  
      
 

      
  
}
// 228 - 260
double matrix[][2]={ 
 { -0.211566 , 0.04057062  } ,
{ -0.182683 , 0.117258  } ,
{ -0.153751 , 0.1942335 } ,
{ -0.124818 , 0.2714503 } ,
{ -0.095930 , 0.3488602 } ,
{ -0.067131 , 0.4264143 } ,
{ -0.038465 , 0.5040643 } ,
{ -0.009978 , 0.5817614 } ,
{ 0.018283  , 0.6594548 } ,
{ 0.046278  , 0.7370949 } ,
{ 0.073964  , 0.8146355 } ,
{ 0.101297  , 0.8920226 } ,
{ 0.128237  , 0.9692082 } ,
{ 0.154744  , 1.046144  } ,
{ 0.180784  , 1.122775  } ,
{ 0.206310  , 1.19906 } ,
{ 0.231289  , 1.27495 } ,
{ 0.255685  , 1.350395  } ,
{ 0.279470  , 1.425348  } ,
{ 0.302605  , 1.499762  } ,
{ 0.325061  , 1.573591  } ,
{ 0.346815  , 1.646792  } ,
{ 0.367835  , 1.719314  } ,
{ 0.388097  , 1.791115  } ,
{ 0.407577  , 1.862154  } ,
{ 0.426256  , 1.932392  } ,
{ 0.444113  , 2.001784  } ,
{ 0.461130  , 2.070297  } ,
{ 0.477288  , 2.137879  } ,
{ 0.492579  , 2.204504  } ,
{ 0.506992  , 2.27013 } ,
{ 0.520508  , 2.334722  } ,
{ 0.533129  , 2.398254  } ,
{ 0.544840  , 2.460686  } ,
{ 0.555652  , 2.521984  } ,
{ 0.565549  , 2.582124  } ,
{ 0.574544  , 2.641077  } ,
{ 0.582630  , 2.69881 } ,
{ 0.589815  , 2.755303  } ,
{ 0.596100  , 2.81053 } ,
{ 0.601489  , 2.864462  } ,
{ 0.605999  , 2.917083  } ,
{ 0.609636  , 2.968377  } ,
{ 0.612416  , 3.018316  } ,
{ 0.614346  , 3.066886  } ,
{ 0.615446  , 3.114069  } ,
{ 0.615732  , 3.159852  } ,
{ 0.615219  , 3.204221  } ,
{ 0.613931  , 3.247164  } ,
{ 0.611884  , 3.288668  } ,
{ 0.609097  , 3.328726  } ,
{ 0.605591  , 3.367323  } ,
{ 0.601389  , 3.404454  } ,
{ 0.596523  , 3.440108  } ,
{ 0.591007  , 3.474287  } ,
{ 0.584870  , 3.506982  } ,
{ 0.578138  , 3.538191  } ,
{ 0.570836  , 3.56791 } ,
{ 0.562982  , 3.59614 } ,
{ 0.554614  , 3.622879  } ,
{ 0.545754  , 3.648122  } ,
{ 0.536431  , 3.671882  } ,
{ 0.526668  , 3.694151  } ,
{ 0.516494  , 3.714936  } ,
{ 0.505936  , 3.734237  } ,
{ 0.495024  , 3.752065  } ,
{ 0.483777  , 3.768416  } ,
{ 0.472234  , 3.783307  } ,
{ 0.460411  , 3.796736  } ,
{ 0.448344  , 3.808711  } ,
{ 0.436054  , 3.819239  } ,
{ 0.423569  , 3.828331  } ,
{ 0.410913  , 3.835995  } ,
{ 0.398110  , 3.842237  } ,
{ 0.385186  , 3.847066  } ,
{ 0.372169  , 3.850493  } ,
{ 0.359081  , 3.852525  } ,
{ 0.345949  , 3.853183  } ,
{ 0.332791  , 3.852469  } ,
{ 0.319636  , 3.850394  } ,
{ 0.306507  , 3.846976  } ,
{ 0.293422  , 3.842227  } ,
{ 0.280402  , 3.836155  } ,
{ 0.267473  , 3.828774  } ,
{ 0.254659  , 3.820097  } ,
{ 0.241971  , 3.810141  } ,
{ 0.229436  , 3.798914  } ,
{ 0.217072  , 3.786432  } ,
{ 0.204901  , 3.772707  } ,
{ 0.192940  , 3.757755  } ,
{ 0.181208  , 3.74159 } ,
{ 0.169724  , 3.724227  } ,
{ 0.158508  , 3.70568 } ,
{ 0.147571  , 3.685967  } ,
{ 0.136931  , 3.665105  } ,
{ 0.126611  , 3.643105  } ,
{ 0.116618  , 3.619984  } ,
{ 0.106972  , 3.59576 } ,
{ 0.097687  , 3.570446  } ,
{ 0.088772  , 3.544063  } ,
{ 0.080250  , 3.516622  } ,
{ 0.072130  , 3.488142  } ,
{ 0.064422  , 3.458642  } ,
{ 0.057141  , 3.428136  } ,
{ 0.050298  , 3.396641  } ,
{ 0.043902  , 3.364177  } ,
{ 0.037965  , 3.330757  } ,
{ 0.032495  , 3.296401  } ,
{ 0.027499  , 3.261124  } ,
{ 0.022988  , 3.224946  } ,
{ 0.018966  , 3.187883  } ,
{ 0.015439  , 3.149954  } ,
{ 0.012414  , 3.111175  } ,
{ 0.009889  , 3.071564  } ,
{ 0.007879  , 3.031136  } ,
{ 0.006378  , 2.989911  } ,
{ 0.005386  , 2.947906  } ,
{ 0.004906  , 2.905138  } ,
{ 0.004937  , 2.861626  } ,
{ 0.005474  , 2.817384  } ,
{ 0.006519  , 2.772428  } ,
{ 0.008061  , 2.726776  } ,
{ 0.010104  , 2.680449  } ,
{ 0.012632  , 2.633453  } ,
{ 0.015632  , 2.585812  } ,
{ 0.019109  , 2.537539  } ,
{ 0.023057  , 2.488652  } ,
{ 0.027447  , 2.439162  } ,
{ 0.032272  , 2.389086  } ,
{ 0.037522  , 2.33844 } ,
{ 0.043185  , 2.287239  } ,
{ 0.049240  , 2.235492  } ,
{ 0.055667  , 2.183218  } ,
{ 0.062450  , 2.130424  } ,
{ 0.069571  , 2.077126  } ,
{ 0.077005  , 2.023332  } ,
{ 0.084733  , 1.96906 } ,
{ 0.092737  , 1.914324  } ,
{ 0.100987  , 1.859127  } ,
{ 0.109460  , 1.803478  } ,
{ 0.118130  , 1.747394  } ,
{ 0.126972  , 1.690881  } ,
{ 0.135961  , 1.63395 } ,
{ 0.145069  , 1.576611  } ,
{ 0.154260  , 1.518864  } ,
{ 0.163512  , 1.46073 } ,
{ 0.172796  , 1.402207  } ,
{ 0.182081  , 1.343301  } ,
{ 0.191338  , 1.284027  } ,
{ 0.200533  , 1.224386  } ,
{ 0.209641  , 1.164389  } ,
{ 0.218625  , 1.104034  } ,
{ 0.227461  , 1.043332  } ,
{ 0.236113  , 0.9822878 } ,
{ 0.244559  , 0.920911  } ,
{ 0.252765  , 0.859203  } ,
{ 0.260698  , 0.7971615 } ,
{ 0.268332  , 0.7347999 } ,
{ 0.275640  , 0.6721231 } ,
{ 0.282594  , 0.6091283 } ,
{ 0.289168  , 0.5458291 } ,
{ 0.295332  , 0.4822265 } ,
{ 0.301064  , 0.41832 } ,
{ 0.306340  , 0.3541241 } ,
{ 0.311137  , 0.2896397 } ,
{ 0.315431  , 0.2248719 } ,
{ 0.319203  , 0.1598286 } ,
{ 0.322433  , 0.09451573  } ,
{ 0.325104  , 0.02893899  } ,
{ 0.327199  , -0.03689422 } ,
{ 0.328700  , -0.1029755  } ,
{ 0.329597  , -0.1692978  } ,
{ 0.329874  , -0.2358528  } ,
{ 0.329528  , -0.3026282  } ,
{ 0.328546  , -0.3696117  } ,
{ 0.326914  , -0.4368025  } ,
{ 0.324630  , -0.5041841  } ,
{ 0.321694  , -0.5717416  } ,
{ 0.318101  , -0.6394637  } ,
{ 0.313858  , -0.7073377  } ,
{ 0.308955  , -0.7753455  } ,
{ 0.303399  , -0.8434727  } ,
{ 0.297192  , -0.9117028  } ,
{ 0.290352  , -0.9800193  } ,
{ 0.282874  , -1.048399 } ,
{ 0.274776  , -1.116826 } ,
{ 0.266060  , -1.185278 } ,
{ 0.256745  , -1.253732 } ,
{ 0.246845  , -1.322163 } ,
{ 0.236373  , -1.390549 } ,
{ 0.225350  , -1.458871 } ,
{ 0.213793  , -1.527096 } ,
{ 0.201723  , -1.595198 } ,
{ 0.189160  , -1.663148 } ,
{ 0.176121  , -1.730918 } ,
{ 0.162635  , -1.798478 } ,
{ 0.148727  , -1.865796 } ,
{ 0.134417  , -1.932842 } ,
{ 0.119731  , -1.99958  } ,
{ 0.104700  , -2.065978 } ,
{ 0.089344  , -2.131997 } ,
{ 0.073701  , -2.197609 } ,
{ 0.057790  , -2.262774 } ,
{ 0.041649  , -2.327459 } ,
{ 0.025299  , -2.391621 } ,
{ 0.008774  , -2.455223 } ,
{ -0.007898 , -2.518232 } ,
{ -0.024692 , -2.580602 } ,
{ -0.041570 , -2.6423 } ,
{ -0.058516 , -2.703279 } ,
{ -0.075491 , -2.763506 } ,
{ -0.092472 , -2.822938 } ,
{ -0.109426 , -2.881535 } ,
{ -0.126326 , -2.939258 } ,
{ -0.143150 , -2.996068 } ,
{ -0.159868 , -3.051923 } ,
{ -0.176452 , -3.106784 } ,
{ -0.192881 , -3.160612 } ,
{ -0.209133 , -3.213367 } ,
{ -0.225181 , -3.265013 } ,
{ -0.241003 , -3.315509 } ,
{ -0.256580 , -3.364817 } ,
{ -0.271892 , -3.412902 } ,
{ -0.286919 , -3.459729 } ,
{ -0.301643 , -3.505259 } ,
{ -0.316047 , -3.549461 } ,
{ -0.330114 , -3.592298 } ,
{ -0.343833 , -3.633741 } ,
{ -0.357194 , -3.673759 } ,
{ -0.370177 , -3.712317 } ,
{ -0.382771 , -3.749389 } ,
{ -0.394969 , -3.78495  } ,
{ -0.406764 , -3.818968 } ,
{ -0.418143 , -3.851419 } ,
{ -0.429109 , -3.882279 } ,
{ -0.439656 , -3.911523 } ,
{ -0.449775 , -3.939135 } ,
{ -0.459457 , -3.965088 } ,
{ -0.468714 , -3.989368 } ,
{ -0.477540 , -4.011956 } ,
{ -0.485941 , -4.032841 } ,
{ -0.493903 , -4.052008 } ,
{ -0.501439 , -4.06944  } ,
{ -0.508549 , -4.085126 } ,
{ -0.515236 , -4.099064 } ,
{ -0.521507 , -4.111239 } ,
{ -0.527363 , -4.12165  } ,
{ -0.532819 , -4.130285 } ,
{ -0.537877 , -4.137144 } ,
{ -0.542534 , -4.142229 } ,
{ -0.546809 , -4.145531 } ,
{ -0.550702 , -4.147056 } ,
{ -0.554223 , -4.146819 } ,
{ -0.557378 , -4.144806 } ,
{ -0.560183 , -4.141026 } ,
{ -0.562634 , -4.13548  } ,
{ -0.564747 , -4.128191 } ,
{ -0.566529 , -4.119158 } ,
{ -0.567984 , -4.108391 } ,
{ -0.569128 , -4.095898 } ,
{ -0.569959 , -4.081697 } ,
{ -0.570490 , -4.065799 } ,
{ -0.570725 , -4.048212 } ,
{ -0.570666 , -4.028958 } ,
{ -0.570333 , -4.008053 } ,
{ -0.569718 , -3.985509 } ,
{ -0.568834 , -3.961343 } ,
{ -0.567681 , -3.935575 } ,
{ -0.566264 , -3.908223 } ,
{ -0.564585 , -3.879305 } ,
{ -0.562645 , -3.848844 } ,
{ -0.560452 , -3.816857 } ,
{ -0.558004 , -3.783366 } ,
{ -0.555299 , -3.748389 } ,
{ -0.552337 , -3.711948 } ,
{ -0.549123 , -3.674062 } ,
{ -0.545646 , -3.634758 } ,
{ -0.541906 , -3.594056 } ,
{ -0.537902 , -3.551977 } ,
{ -0.533637 , -3.508543 } ,
{ -0.529094 , -3.463777 } ,
{ -0.524276 , -3.417702 } ,
{ -0.519174 , -3.370336 } ,
{ -0.513783 , -3.321707 } ,
{ -0.508097 , -3.271835 } ,
{ -0.502107 , -3.220742 } ,
{ -0.495807 , -3.168451 } ,
{ -0.489189 , -3.114985 } ,
{ -0.482247 , -3.060367 } ,
{ -0.474967 , -3.004619 } ,
{ -0.467344 , -2.947762 } ,
{ -0.459367 , -2.88982  } ,
{ -0.451035 , -2.830814 } ,
{ -0.442331 , -2.770768 } ,
{ -0.433245 , -2.709704 } ,
{ -0.423772 , -2.647642 } ,
{ -0.413907 , -2.584608 } ,
{ -0.403633 , -2.520623 } ,
{ -0.392948 , -2.455711 } ,
{ -0.381842 , -2.389891 } ,
{ -0.370307 , -2.323187 } ,
{ -0.358341 , -2.255624 } ,
{ -0.345930 , -2.187226 } ,
{ -0.333077 , -2.118017 } ,
{ -0.319773 , -2.048016 } ,
{ -0.306020 , -1.977252 } ,
{ -0.291809 , -1.905744 } ,
{ -0.277137 , -1.83352  } ,
{ -0.262011 , -1.760603 } ,
{ -0.246430 , -1.687022 } ,
{ -0.230392 , -1.612798 } ,
{ -0.213899 , -1.537957 } ,
{ -0.196955 , -1.462534 } ,
{ -0.179571 , -1.386549 } ,
{ -0.161750 , -1.31003  } ,
{ -0.143493 , -1.233002 } ,
{ -0.124811 , -1.155504 } ,
{ -0.105719 , -1.077555 } ,
{ -0.086225 , -0.9991868  } ,
{ -0.066339 , -0.9204318  } ,
{ -0.046084 , -0.8413204  } ,
{ -0.025468 , -0.7618856  } ,
{ -0.004512 , -0.682162 } ,
{ 0.016773  , -0.6021799  } ,
{ 0.038358  , -0.5219736  } ,
{ 0.060228  , -0.4415759  } ,
{ 0.082357  , -0.3610209  } ,
{ 0.104725  , -0.2803443  } ,
{ 0.127309  , -0.1995859  } ,
{ 0.150084  , -0.1187771  } ,
{ 0.173021  , -0.03795792 } ,
{ 0.196097  , 0.04283426  } ,
{ 0.219279  , 0.1235609 } ,
{ 0.242543  , 0.2041838 } ,
{ 0.265857  , 0.2846656 } ,
{ 0.289191  , 0.3649655 } ,
{ 0.312509  , 0.4450447 } ,
{ 0.335788  , 0.5248609 } ,
{ 0.358990  , 0.6043752 } ,
{ 0.382087  , 0.6835463 } ,
{ 0.405044  , 0.7623338 } ,
{ 0.427829  , 0.8406963 } ,
{ 0.450410  , 0.9185924 } ,
{ 0.472756  , 0.9959834 } ,
{ 0.494831  , 1.072825  } ,
{ 0.516605  , 1.149078  } ,
{ 0.538049  , 1.224698  } ,
{ 0.559126  , 1.299648  } ,
{ 0.579809  , 1.373889  } ,
{ 0.600067  , 1.447375  } ,
{ 0.619871  , 1.520073  } ,
{ 0.639190  , 1.591939  } ,
{ 0.657997  , 1.662937  } ,
{ 0.676266  , 1.733025  } ,
{ 0.693972  , 1.802167  } ,
{ 0.711084  , 1.870326  } ,
{ 0.727592  , 1.937463  } ,
{ 0.743455  , 2.003546  } ,
{ 0.758663  , 2.068542  } ,
{ 0.773192  , 2.132408  } ,
{ 0.787029  , 2.195111  } ,
{ 0.800148  , 2.256626  } ,
{ 0.812534  , 2.316921  } ,
{ 0.824179  , 2.375963  } ,
{ 0.835067  , 2.433722  } ,
{ 0.845182  , 2.490172  } ,
{ 0.854517  , 2.545278  } ,
{ 0.863060  , 2.599021  } ,
{ 0.870809  , 2.651378  } ,
{ 0.877756  , 2.702316  } ,
{ 0.883888  , 2.751819  } ,
{ 0.889205  , 2.799869  } ,
{ 0.893714  , 2.846441  } ,
{ 0.897408  , 2.891521  } ,
{ 0.900297  , 2.935081  } ,
{ 0.902372  , 2.977114  } ,
{ 0.903634  , 3.017605  } ,
{ 0.904093  , 3.056535  } ,
{ 0.903751  , 3.093893  } ,
{ 0.902622  , 3.129673  } ,
{ 0.900701  , 3.163857  } ,
{ 0.898009  , 3.19644 } ,
{ 0.894551  , 3.227418  } ,
{ 0.890329  , 3.256785  } ,
{ 0.885362  , 3.284529  } ,
{ 0.879656  , 3.310646  } ,
{ 0.873232  , 3.335142  } ,
{ 0.866101  , 3.358012  } ,
{ 0.858273  , 3.379253  } ,
{ 0.849747  , 3.398863  } ,
{ 0.840552  , 3.416852  } ,
{ 0.830706  , 3.433218  } ,
{ 0.820220  , 3.447965  } ,
{ 0.809110  , 3.461102  } ,
{ 0.797390  , 3.472631  } ,
{ 0.785076  , 3.482558  } ,
{ 0.772190  , 3.490885  } ,
{ 0.758739  , 3.497635  } ,
{ 0.744735  , 3.502807  } ,
{ 0.730203  , 3.506409  } ,
{ 0.715155  , 3.508464  } ,
{ 0.699606  , 3.508978  } ,
{ 0.683569  , 3.507964  } ,
{ 0.667066  , 3.505429  } ,
{ 0.650113  , 3.501391  } ,
{ 0.632723  , 3.495868  } ,
{ 0.614908  , 3.488868  } ,
{ 0.596685  , 3.480415  } ,
{ 0.578068  , 3.470523  } ,
{ 0.559077  , 3.459205  } ,
{ 0.539726  , 3.446479  } ,
{ 0.520025  , 3.432367  } ,
{ 0.499999  , 3.416886  } ,
{ 0.479653  , 3.400059  } ,
{ 0.459007  , 3.381899  } ,
{ 0.438071  , 3.36243 } ,
{ 0.416868  , 3.341671  } ,
{ 0.395408  , 3.319644  } ,
{ 0.373703  , 3.296371  } ,
{ 0.351773  , 3.271872  } ,
{ 0.329635  , 3.246171  } ,
{ 0.307302  , 3.21929 } ,
{ 0.284787  , 3.191253  } ,
{ 0.262107  , 3.162081  } ,
{ 0.239282  , 3.131801  } ,
{ 0.216326  , 3.100435  } ,
{ 0.193251  , 3.06801 } ,
{ 0.170080  , 3.034549  } ,
{ 0.146830  , 3.000078  } ,
{ 0.123515  , 2.964626  } ,
{ 0.100153  , 2.928216  } ,
{ 0.076762  , 2.890874  } ,
{ 0.053364  , 2.852632  } ,
{ 0.029974  , 2.813514  } ,
{ 0.006610  , 2.773549  } ,
{ -0.016705 , 2.732763  } ,
{ -0.039950 , 2.691185  } ,
{ -0.063109 , 2.648848  } ,
{ -0.086163 , 2.605778  } ,
{ -0.109090 , 2.562006  } ,
{ -0.131867 , 2.517562  } ,
{ -0.154474 , 2.472475  } ,
{ -0.176889 , 2.426775  } ,
{ -0.199091 , 2.380497  } ,
{ -0.221057 , 2.333669  } ,
{ -0.242767 , 2.286322  } ,
{ -0.264196 , 2.238491  } ,
{ -0.285326 , 2.190207  } ,
{ -0.306135 , 2.1415  } ,
{ -0.326600 , 2.092404  } ,
{ -0.346697 , 2.04295 } ,
{ -0.366406 , 1.993176  } ,
{ -0.385706 , 1.94311 } ,
{ -0.404574 , 1.892787  } ,
{ -0.422990 , 1.842239  } ,
{ -0.440933 , 1.791501  } ,
{ -0.458383 , 1.740604  } ,
{ -0.475317 , 1.68958 } ,
{ -0.491720 , 1.638464  } ,
{ -0.507574 , 1.58729 } ,
{ -0.522857 , 1.536088  } ,
{ -0.537550 , 1.484889  } ,
{ -0.551640 , 1.433729  } ,
{ -0.565106 , 1.382637  } ,
{ -0.577936 , 1.331645  } ,
{ -0.590120 , 1.280784  } ,
{ -0.601640 , 1.230088  } ,
{ -0.612484 , 1.179584  } ,
{ -0.622636 , 1.129301  } ,
{ -0.632088 , 1.079274  } ,
{ -0.640834 , 1.029525  } ,
{ -0.648865 , 0.9800884 } ,
{ -0.656176 , 0.9309834 } ,
{ -0.662752 , 0.8822426 } ,
{ -0.668590 , 0.8338878 } ,
{ -0.673686 , 0.7859482 } ,
{ -0.678042 , 0.7384424 } ,
{ -0.681658 , 0.6913977 } ,
{ -0.684535 , 0.6448376 } ,
{ -0.686671 , 0.5987813 } ,
{ -0.688062 , 0.5532485 } ,
{ -0.688720 , 0.5082573 } ,
{ -0.688647 , 0.4638307 } ,
{ -0.687858 , 0.4199769 } ,
{ -0.686346 , 0.3767196 } ,
{ -0.684120 , 0.3340692 } ,
{ -0.681209 , 0.2920401 } ,
{ -0.677606 , 0.2506471 } ,
{ -0.673334 , 0.2099047 } ,
{ -0.668392 , 0.169816  } ,
{ -0.662805 , 0.1303923 } ,
{ -0.656588 , 0.091644  } ,
{ -0.649759 , 0.05357318  } ,
{ -0.642326 , 0.01619188  } ,
{ -0.634318 , -0.02050959 } ,
{ -0.625747 , -0.05651319 } ,
{ -0.616635 , -0.09181961 } ,
{ -0.607009 , -0.1264337  } ,
{ -0.596881 , -0.1603499  } ,
{ -0.586281 , -0.1935721  } ,
{ -0.575227 , -0.2261139  } ,
{ -0.563733 , -0.2579659  } ,
{ -0.551834 , -0.2891333  } ,
{ -0.539552 , -0.319627 } ,
{ -0.526902 , -0.3494529  } ,
{ -0.513923 , -0.3786099  } ,
{ -0.500628 , -0.407113 } ,
{ -0.487043 , -0.4349703  } ,
{ -0.473204 , -0.4621936  } ,
{ -0.459122 , -0.4887927  } ,
{ -0.444819 , -0.5147805  } ,
{ -0.430328 , -0.5401664  } ,
{ -0.415683 , -0.5649623  } ,
{ -0.400898 , -0.5891832  } ,
{ -0.385979 , -0.6128427  } ,
{ -0.370976 , -0.6359507  } ,
{ -0.355899 , -0.6585307  } ,
{ -0.340768 , -0.6805858  } ,
{ -0.325600 , -0.7021271  } ,
{ -0.310428 , -0.7231801  } ,
{ -0.295269 , -0.7437571  } ,
{ -0.280137 , -0.7638724  } ,
{ -0.265053 , -0.7835433  } ,
{ -0.250040 , -0.8027763  } ,
{ -0.235113 , -0.8215986  } ,
{ -0.220287 , -0.8400169  } ,
{ -0.205576 , -0.8580469  } ,
{ -0.191002 , -0.8756965  } ,
{ -0.176577 , -0.8929881  } ,
{ -0.162303 , -0.9099292  } ,
{ -0.148209 , -0.9265305  } ,
{ -0.134301 , -0.942808 } ,
{ -0.120588 , -0.9587693  } ,
{ -0.107075 , -0.9744279  } ,
{ -0.093781 , -0.9897969  } ,
{ -0.080701 , -1.004886 } ,
{ -0.067855 , -1.019706 } ,
{ -0.055246 , -1.034266 } ,
{ -0.042876 , -1.048568 } ,
{ -0.030752 , -1.062626 } ,
{ -0.018878 , -1.076446 } ,
{ -0.007257 , -1.090034 } ,
{ 0.004111  , -1.103391 } ,
{ 0.015220  , -1.116528 } ,
{ 0.026062  , -1.129445 } ,
{ 0.036645  , -1.142148 } ,
{ 0.046965  , -1.154641 } ,
{ 0.057021  , -1.166925 } ,
{ 0.066813  , -1.178999 } ,
{ 0.076342  , -1.19087  } ,
{ 0.085609  , -1.202536 } ,
{ 0.094618  , -1.213996 } ,
{ 0.103366  , -1.225248 } ,
{ 0.111855  , -1.236292 } ,
{ 0.120087  , -1.247129 } ,
{ 0.128064  , -1.257756 } ,
{ 0.135792  , -1.268173 } ,
{ 0.143270  , -1.278374 } ,
{ 0.150496  , -1.288356 } ,
{ 0.157478  , -1.298121 } ,
{ 0.164213  , -1.307658 } ,
{ 0.170696  , -1.316966 } ,
{ 0.176943  , -1.326045 } ,
{ 0.182943  , -1.334885 } ,
{ 0.188704  , -1.343486 } ,
{ 0.194218  , -1.351841 } ,
{ 0.199493  , -1.359949 } ,
{ 0.204527  , -1.367804 } ,
{ 0.209319  , -1.375402 } ,
{ 0.213867  , -1.382739 } ,
{ 0.218168  , -1.38981  } ,
{ 0.222219  , -1.396614 } ,
{ 0.226026  , -1.403146 } ,
{ 0.229584  , -1.409401 } ,
{ 0.232886  , -1.415378 } ,
{ 0.235937  , -1.421071 } ,
{ 0.238730  , -1.426476 } ,
{ 0.241259  , -1.431592 } ,
{ 0.243522  , -1.436422 } ,
{ 0.245515  , -1.440962 } ,
{ 0.247238  , -1.445205 } ,
{ 0.248684  , -1.449158 } ,
{ 0.249847  , -1.452813 } ,
{ 0.250730  , -1.456172 } ,
{ 0.251322  , -1.459238 } ,
{ 0.251622  , -1.46201  } ,
{ 0.251618  , -1.464483 } ,
{ 0.251322  , -1.466668 } ,
{ 0.250720  , -1.46855  } ,
{ 0.249814  , -1.470149 } ,
{ 0.248591  , -1.47145  } ,
{ 0.247067  , -1.472465 } ,
{ 0.245222  , -1.473196 } ,
{ 0.243061  , -1.473643 } ,
{ 0.240585  , -1.473805 } ,
{ 0.237784  , -1.473678 } ,
{ 0.234667  , -1.473286 } ,
{ 0.231238  , -1.472621 } ,
{ 0.227488  , -1.471687 } ,
{ 0.223431  , -1.470477 } ,
{ 0.219064  , -1.469007 }
};   
  
  
void loop(){
      Serial.print("Micros: ");
      Serial.println(micros()-t);
  
  //bno.getEvent (&event);

  
Serial.println ("  ");
   
     cabeceoPosterior=matrix[muestra][0]*deg2rad; //No estoy demasiado seguro de que sea el eje correcto
     alabeoPosterior=matrix[muestra][1]*deg2rad;
 //   Serial.println ("  ");
     //Serial.print (" ");
    Serial.print((matrix[muestra][0]/deg2rad));
    Serial.print (" ");
    Serial.print ((matrix[muestra][1]/deg2rad));
  moverMotores(); 
  t = micros();
  muestra++;
  if (muestra == MAX){
    exit(0);
   }
   delay(50);
   
}


